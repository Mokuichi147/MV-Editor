<RootWidget>:
    canvas.before:
        Color:
            rgba: 0.11, 0.11, 0.11, 1
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: 5
        # upper half
        BoxLayout:
            id: vertical_splitter_upper
            orientation: 'horizontal'
            size_hint: 1, 2.3
            BoxLayout:
                id: horizontal_splitter_left
                orientation: 'vertical'
                canvas.before:
                    Color:
                        rgba: 0.15, 0.15, 0.15, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size[0], self.size[1]
                # mode selection
                BoxLayout:
                    orientation: 'horizontal'
                    padding: 0, 0, 0, 0
                    size_hint: 1, None
                    height: 32
                    canvas.before:
                        Color:
                            rgba: 0.30, 0.30, 0.40, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size[0], self.size[1]
                    ToggleButton:
                        id: project_button
                        group: 'mode'
                        state: 'down'
                        text: 'Project'
                        on_press: print('Project')
                        background_normal: 'resources/mode.png'
                        background_down: 'resources/mode_down.png'
                        border: 0, 0, 0, 0
                        size: 150, 32
                        size_hint: None, None
                    ToggleButton:
                        group: 'mode'
                        text: 'Setting'
                        on_press: print('Setting')
                        background_normal: 'resources/mode.png'
                        background_down: 'resources/mode_down.png'
                        border: 0, 0, 0, 0
                        size: 150, 32
                        size_hint: None, None
                    ToggleButton:
                        group: 'mode'
                        text: 'Output'
                        on_press: print('Output')
                        background_normal: 'resources/mode.png'
                        background_down: 'resources/mode_down.png'
                        border: 0, 0, 0, 0
                        size: 150, 32
                        size_hint: None, None
                    Label:
                        size_hint: 1, 1
                # file selection
                BoxLayout:
                    orientation: 'horizontal'
                    padding: 0, 2, 0, 0
                    BoxLayout:
                        orientation: 'vertical'
                        padding: 0, 0, 0, 0
                        size_hint: None, 1
                        width: project_dirs.width
                        # directories
                        Button:
                            id: project_select
                            on_press: root.project_selected()
                            text: '> TestProject' if project_dirs.width != 0 else ''
                            background_normal: 'resources/project_select.png' if project_dirs.width != 0 else 'resources/project_select_clear.png'
                            background_down: 'resources/project_select.png' if project_dirs.width != 0 else 'resources/project_select_clear.png'
                            size_hint: None, None
                            height: 50
                            width: project_dirs.width
                            halign: 'left'
                            valign: 'top'
                            text_size: project_dirs.width-20, self.height/2
                        ScrollView:
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                            size_hint: None, None
                            width: 150
                            height: file_icon_view.height - project_select.height
                            BoxLayout:
                                id: project_dirs
                                orientation: 'vertical'
                                size_hint_y: None
                                height: self.minimum_height
                    # files
                    FileChooserIconView:
                        id: file_icon_view
                        rootpath: ''
                        filters: ['*.wav', '*.mp3', '*.mp4', '*.mov', '*.jpg', '*.png', '*.ttf', '*.otf']
                        on_selection: root.file_selected(self.selection)
            # video preview
            Button:
                id: horizontal_splitter
                on_press: root.button_moved('horizontal_splitter')
                background_normal: 'resources/splitter.png'
                background_down: 'resources/splitter.png'
                border: 10, 0, 10, 0
                size: 5, root.size[1]-10
                size_hint: None, None
            BoxLayout:
                id: horizontal_splitter_right
                orientation: 'vertical'
                size_hint: 1.9, 1
                canvas.before:
                    Color:
                        rgba: 0.15, 0.15, 0.15, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                Image:
                    allow_stretch: True
                    texture: root.image_texture
                BoxLayout:
                    orientation: 'horizontal'
                    padding: 5, 5, 0, 4
                    size_hint: 1, None
                    height: 42
                    Button:
                        on_press: root.set_zero_frame()
                        background_normal: 'resources/set_zero_frame_button.png'
                        background_down: 'resources/set_zero_frame_button_down.png'
                        border: 0, 0, 0, 0
                        size: 32, 32
                        size_hint: None, None
                    Button:
                        on_press: root.previous_frame()
                        background_normal: 'resources/previous_frame_button.png'
                        background_down: 'resources/previous_frame_button_down.png'
                        border: 0, 0, 0, 0
                        size: 32, 32
                        size_hint: None, None
                    Button:
                        id: playback_button
                        on_press: root.playback_start_or_stop()
                        background_normal: 'resources/playback_button.png'
                        background_down: 'resources/playback_stop_button_down.png'
                        border: 0, 0, 0, 0
                        size: 32, 32
                        size_hint: None, None
                    Button:
                        on_press: root.next_frame()
                        background_normal: 'resources/next_frame_button.png'
                        background_down: 'resources/next_frame_button_down.png'
                        border: 0, 0, 0, 0
                        size: 32, 32
                        size_hint: None, None
                    Button:
                        on_press: print('fullscreen preview')
                        background_normal: 'resources/fullscreen_preview_button.png'
                        background_down: 'resources/fullscreen_preview_button_down.png'
                        border: 0, 0, 0, 0
                        size: 32, 32
                        size_hint: None, None
                    Slider:
                        id: video_time_slider
                        min: 0
                        max: root.frame_max
                        value: 0
                        on_value: root.cursor_moved(self.value)
                        step: 1
                        cursor_image: 'resources/cursor.png'
                        value_track: True
                        value_track_color: 90/255, 90/255, 255/255, 1
                        size_hint: 1, 1
                    Label:
                        id: video_time_label
                        text: '0:00'
                        size: 50, 32
                        size_hint: None, None
        Button:
            id: vertical_splitter
            on_press: root.button_moved('vertical_splitter')
            background_normal: 'resources/splitter.png'
            background_down: 'resources/splitter.png'
            border: 0, 10, 0, 10
            size: root.size[0]-10, 5
            size_hint: None, None
        # lower half
        BoxLayout:
            id: vertical_splitter_lower
            canvas.before:
                Color:
                    rgba: 0.15, 0.15, 0.15, 1
                Rectangle:
                    pos: self.pos
                    size: self.size[0], self.size[1]
            padding: 0, 0, 0, 0
            orientation: 'vertical'
            Label:
                text: 'time'
                size_hint: 1, None
                height: 50
                canvas.before:
                    Color:
                        rgba: 0.30, 0.30, 0.40, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size[0], self.size[1]
            ScrollView:
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 1'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image:
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 2'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image:
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 3'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image:
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 4'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image:
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 5'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image:
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, None
                        height: 100
                        Label:
                            text: 'video 6'
                            size_hint: None, 1
                            width: 100
                            canvas.before:
                                Color:
                                    rgba: 0.20, 0.20, 0.25, 1
                                Rectangle:
                                    pos: self.pos
                                    size: self.size[0], self.size[1]
                        Image: